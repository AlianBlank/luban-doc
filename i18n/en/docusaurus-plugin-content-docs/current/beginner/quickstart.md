# Get started quickly

## Install

1. Install [dotnet sdk 7.0](https://dotnet.microsoft.com/download/dotnet/7.0) or higher version sdk
2. Download the [luban_examples project](https://github.com/focus-creative-games/luban_examples). The project contains test configurations and a number of example projects. For convenience, the files mentioned later refer to the files in this project by default.

## Prepare to configure the project

Directly use the MiniTemplate in the luban_examples project, and the subsequent operations will be modified on this basis. You can also copy the MiniTemplate to another directory and modify it, but you need to modify the relevant paths in the `MiniTemplate/gen.bat` file.

## Create Reward table

Create a `reward.xlsx` file in the `MiniTemplate/Datas` directory with the following content:

![reward](/img/cases/quickstart_reward.jpg)

Briefly introduce the file format:

- Line 1 is the field name line. Cell A1 must start with ##. Indicates that this is a valid data table.
- Line 2 is the field type line. The first cell must be ##type.
- Line 3 is the grouping line. `c` indicates that the field belongs to the client, `s` indicates that it belongs to the server, `c,s` indicates that it belongs to all at the same time, and leaving it blank also indicates that it belongs to all.
- Line 4 is a comment line. To ... beginning. There can be 0-N comment lines, and they can appear anywhere.
- From line 5 onwards are data lines.

Luban does not limit the position and number of header lines. Lines like `##xxx` can be ordered and positioned arbitrarily, while `##group` and `##` lines are also optional.

It is recommended to use `xx_yy_zz` style field names, because luban will automatically convert to The name of the naming style recommended by the language. You can also manually specify your desired command style.

Add the reward table declaration to `__tables__.xlsx` in the Datas directory, as shown below：

![reward](/img/cases/quickstart_table.jpg)

At this point, the creation of the reward table is completed!

## project preparation

Take the most common unity + c# + json as an example. 
An example reference project is [Csharp_Unity_Json](https://github.com/focus-creative-games/luban_examples/tree/main/Projects/Csharp_Unity_json),For other types, please refer to the corresponding projects in the Projects directory.

Copy the `Assets\LubanLib` directory in the Csharp_Unity_Json project to your Unity project, the location is not required. **Then enable the unsafe option in Unity's PlayerSettings** (if your project requires not to enable unsafe, please go to the group for help).
At this time, try to compile the project. If there is no compilation error, it means that the Luban related library code has been successfully introduced.


## Prepare to generate scripts

Create a `gen.bat` file and put it under the project (the location is not required).

```bat

set LUBAN_DLL=<Luban.dll path>
set CONF_ROOT=<DataTables path>

dotnet %LUBAN_DLL% ^
    -t client ^
    -c cs-simple-json ^
    -d json  ^
    --schemaPath %CONF_ROOT%\Defines\__root__.xml ^
    -x inputDataDir=%CONF_ROOT%\Datas ^
    -x outputCodeDir=<cs code output directory> ^
    -x outputDataDir=<json data output directory>

pause
```

Briefly introduce the parameters in the bat file：

- LUBAN_DLL Path to the Luban.dll file. Point to `luban_examples/Tools/Luban/Luban.dll`
- CONF_ROOT The path to the configuration project. Point to `luban_examples/DataTables`
- '-t' generate target. It can be a value such as client, server, and all
- '-c' Type of generated code. `cs-simple-json` is to generate c# code that uses SimpleJSON to load json data
- the data type generated by '-d'
- 'inputDataDir' configuration table (eg xlsx) root directory
- 'outputCodeDir' output directory of c# code
- 'outputDataDir' output directory of json data

Adjust the configuration paths in the bat file to appropriate values. If in doubt, you can refer to the `gen.bat` file of the `Csharp_Unity_Json` project. Run the script, if everything is normal, a series of logs will be generated, and the last line is `bye~`.

## load configuration

All configuration tables can be loaded with just one line of code. Only loaded once for the entire game run (unless you want to reload configuration on the fly). In practice, tables are created and saved for later use.

```csharp

string gameConfDir = "<outputDataDir>"; // Replace with the directory pointed to by outputDataDir in gen.bat
var tables = new cfg.Tables(file => JSON.Parse(File.ReadAllText($"{gameConfDir}/{file}.json")));

```

## use configuration

cfg.Tables contains an instance field for all configuration tables. After loading cfg.Tables, use `tables.<table name>` to get the table instance, and then perform subsequent operations on the table.
For example, we want to print the reward information of Reward table id = 1001, the code is as follows：

```csharp
cfg.demo.Reward reward = tables.TbReward.Get(1001);
Console.WriteLine("reward:{0}", reward);
```

You may notice that the first letters of the field names id, name, and desc in the reward table are capitalized. This is because the tool will automatically convert the field name of the corresponding code style according to the output language, that is, boo_bar will be converted to a name like BooBar.
Therefore, it is recommended to uniformly use the style of xx_yy_zz for field names in the configuration.

This completes the configuration usage example!

